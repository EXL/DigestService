Вставка Unescaped HTML, нужно быть осторожным.
Может быть алгоритм такой? Удаляем все HTML-теги из сообщения дайджеста. Затем подсвечиваем необходимое вручную.
А необходимое наверное только ссылки.

